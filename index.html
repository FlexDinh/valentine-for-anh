<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For √Ånh ‚ù§Ô∏è</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;600;700&family=Pacifico&display=swap"
        rel="stylesheet">

    <!-- Custom Config for Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rose-night': '#0f172a',
                        'love-pink': '#be185d',
                        'deep-purple': '#581c87',
                    },
                    fontFamily: {
                        'pacifico': ['Pacifico', 'cursive'],
                        'dancing': ['Dancing Script', 'cursive'],
                        'nunito': ['Nunito', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slight': 'bounceSlight 2s infinite',
                        'heartbeat': 'heartbeat 1.5s ease-in-out infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'fade-in-up': 'fadeInUp 1s ease-out forwards',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        bounceSlight: {
                            '0%, 100%': { transform: 'translateY(-5%)' },
                            '50%': { transform: 'translateY(0)' },
                        },
                        heartbeat: {
                            '0%': { transform: 'scale(1)' },
                            '14%': { transform: 'scale(1.1)' },
                            '28%': { transform: 'scale(1)' },
                            '42%': { transform: 'scale(1.1)' },
                            '70%': { transform: 'scale(1)' },
                        },
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Global Reset for Mobile */
        body,
        html {
            height: 100%;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="%23be185d"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>'), auto;
        }

        /* 3D Gift Box Styles */
        .gift-container {
            perspective: 1000px;
        }

        .gift-box {
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s;
            cursor: pointer;
        }

        .gift-box.open .lid {
            transform: rotateX(-110deg);
        }

        /* Particle Canvas */
        #particles-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Float Heart Interaction */
        .click-heart {
            position: absolute;
            animation: floatUp 1.5s ease-out forwards;
            pointer-events: none;
            z-index: 9999;
            font-size: 1.5rem;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) scale(1.5);
                opacity: 0;
            }
        }
    </style>
</head>

<body
    class="bg-[conic-gradient(at_top_right,_var(--tw-gradient-stops))] from-slate-900 via-purple-900 to-rose-900 text-white font-nunito h-full w-full select-none overflow-hidden">

    <audio id="bg-music" loop>
        <!-- Romantic Music Placeholder -->
        <source src="https://cdn.pixabay.com/download/audio/2022/02/07/audio_13a3754409.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <canvas id="particles-canvas"></canvas>

    <!-- ==================== LOCK SCREEN ==================== -->
    <div id="lock-screen"
        class="absolute inset-0 z-50 flex flex-col items-center justify-center bg-[url('https://images.unsplash.com/photo-1518621736915-f3b1c41bfd00?q=80&w=1000&auto=format&fit=crop')] bg-cover bg-center transition-opacity duration-1000">
        <!-- Overlay -->
        <div class="absolute inset-0 bg-black/60 backdrop-blur-md z-0"></div>

        <div class="relative z-10 text-center mb-8 animate-float">
            <div class="text-7xl mb-4 animate-bounce-slight drop-shadow-[0_0_15px_rgba(236,72,153,0.8)]">üíñ</div>
            <h2
                class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-300 to-rose-500 font-pacifico drop-shadow-lg">
                My Valentine</h2>
            <p class="text-sm text-pink-200 mt-2 font-dancing text-xl">M·∫≠t kh·∫©u l√† ng√†y sinh nh·∫≠t b√© √Ånh (ddmm)</p>
        </div>

        <!-- Passcode Display -->
        <div class="relative z-10 flex space-x-4 mb-8">
            <div
                class="dot w-4 h-4 rounded-full border-2 border-pink-400 bg-transparent transition-all duration-200 shadow-[0_0_10px_rgba(236,72,153,0.8)]">
            </div>
            <div
                class="dot w-4 h-4 rounded-full border-2 border-pink-400 bg-transparent transition-all duration-200 shadow-[0_0_10px_rgba(236,72,153,0.8)]">
            </div>
            <div
                class="dot w-4 h-4 rounded-full border-2 border-pink-400 bg-transparent transition-all duration-200 shadow-[0_0_10px_rgba(236,72,153,0.8)]">
            </div>
            <div
                class="dot w-4 h-4 rounded-full border-2 border-pink-400 bg-transparent transition-all duration-200 shadow-[0_0_10px_rgba(236,72,153,0.8)]">
            </div>
        </div>

        <!-- Keypad -->
        <div class="relative z-10 grid grid-cols-3 gap-6 w-72">
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="1">1</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="2">2</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="3">3</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="4">4</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="5">5</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="6">6</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="7">7</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="8">8</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="9">9</button>
            <div class="w-16 h-16"></div>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-pink-500/30 flex items-center justify-center text-2xl font-bold active:bg-pink-500 active:scale-95 transition-all text-pink-100 shadow-lg hover:bg-pink-500/20"
                data-val="0">0</button>
            <button
                class="keypad-btn w-16 h-16 rounded-full bg-transparent flex items-center justify-center text-2xl font-bold text-rose-400 active:scale-95 transition-all"
                data-val="del">‚å´</button>
        </div>

        <p class="relative z-10 text-xs text-pink-300/50 mt-8 animate-pulse">Made for √Ånh</p>
    </div>


    <!-- ==================== MAIN CONTENT ==================== -->
    <main id="main-content"
        class="hidden absolute inset-0 overflow-y-auto no-scrollbar pb-20 opacity-0 transition-opacity duration-1000">

        <button id="music-toggle"
            class="fixed top-6 right-6 z-40 w-12 h-12 rounded-full glass flex items-center justify-center text-pink-300 shadow-xl border border-pink-500/30 animate-pulse-slow">
            üéµ
        </button>

        <!-- Intro -->
        <section class="h-screen flex flex-col items-center justify-center p-6 text-center relative">
            <!-- Decorative Glow -->
            <div class="absolute w-64 h-64 bg-pink-600/20 rounded-full blur-3xl -z-10 animate-pulse"></div>

            <div class="animate-float z-10">
                <h1 class="text-5xl md:text-7xl font-dancing text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-red-600 mb-6 drop-shadow-lg p-2"
                    id="typing-title">
                    <!-- Typing JS will fill this -->
                </h1>
                <p class="text-xl text-purple-200 font-pacifico">Happy Valentine's Day</p>
            </div>

            <div class="mt-16 w-full max-w-sm z-10">
                <div
                    class="glass rounded-3xl p-8 border border-pink-500/30 relative shadow-[0_0_30px_rgba(190,24,93,0.2)]">
                    <div
                        class="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-pink-600 to-purple-600 text-white text-xs px-4 py-1 rounded-full uppercase font-bold tracking-widest shadow-lg">
                        B√™n nhau ƒë∆∞·ª£c
                    </div>
                    <div class="grid grid-cols-4 gap-4 text-center mt-4 text-white">
                        <div class="flex flex-col">
                            <span id="days" class="text-3xl font-bold font-mono text-pink-200">00</span>
                            <span class="text-[10px] uppercase tracking-wider opacity-70">Ng√†y</span>
                        </div>
                        <div class="flex flex-col">
                            <span id="hours" class="text-3xl font-bold font-mono">00</span>
                            <span class="text-[10px] uppercase tracking-wider opacity-70">Gi·ªù</span>
                        </div>
                        <div class="flex flex-col">
                            <span id="minutes" class="text-3xl font-bold font-mono">00</span>
                            <span class="text-[10px] uppercase tracking-wider opacity-70">Ph√∫t</span>
                        </div>
                        <div class="flex flex-col">
                            <span id="seconds"
                                class="text-3xl font-bold font-mono text-pink-500 animate-pulse">00</span>
                            <span class="text-[10px] uppercase tracking-wider opacity-70">Gi√¢y</span>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <span class="text-3xl text-red-500 animate-heartbeat inline-block drop-shadow-md">‚ù§Ô∏è</span>
                    </div>
                </div>
                <p class="mt-4 text-sm text-center text-pink-200/60 font-mono">Since 10/10/2025</p>
            </div>

            <div class="absolute bottom-12 animate-bounce flex flex-col items-center opacity-70">
                <span class="text-xs mb-1">M·ªü qu√† ·ªü d∆∞·ªõi nha</span>
                <span class="text-xl">üëá</span>
            </div>
        </section>

        <!-- New Section: Love Messages (Replcement for Memory Lane) -->
        <section class="min-h-[50vh] flex flex-col items-center justify-center p-6 relative overflow-hidden">
            <!-- Background decoration -->
            <div class="absolute top-10 right-10 text-6xl opacity-10 animate-wiggle">üíå</div>
            <div class="absolute bottom-10 left-10 text-6xl opacity-10 animate-wiggle" style="animation-delay: 1s;">üåπ
            </div>

            <div id="love-carousel"
                class="w-full max-w-md bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10 text-center min-h-[200px] flex items-center justify-center relative shadow-lg">
                <p id="carousel-text"
                    class="text-xl md:text-2xl font-dancing text-pink-100 transition-opacity duration-1000 opacity-100">
                    "C·∫£m ∆°n em ƒë√£ ƒë·∫øn v√† l√†m cu·ªôc s·ªëng c·ªßa anh tr·ªü n√™n r·ª±c r·ª° h∆°n."
                </p>
                <div class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 flex space-x-2">
                    <div class="w-1.5 h-1.5 bg-pink-500 rounded-full animate-pulse"></div>
                    <div class="w-1.5 h-1.5 bg-pink-500 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                    <div class="w-1.5 h-1.5 bg-pink-500 rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                </div>
            </div>
        </section>

        <!-- Gift Section -->
        <section class="h-[80vh] flex flex-col items-center justify-center relative pb-20">

            <div class="z-10 text-center mb-12">
                <h2 class="text-4xl font-dancing text-pink-300 mb-2 drop-shadow-md animate-pulse">M√≥n qu√† nh·ªè</h2>
                <div class="h-1 w-20 bg-pink-500 mx-auto rounded-full opacity-50"></div>
            </div>

            <!-- 3D CSS Box -->
            <div class="gift-container z-10 scale-125" id="gift-box-trigger">
                <div
                    class="gift-box w-40 h-40 bg-pink-600 rounded-lg shadow-[0_20px_60px_rgba(255,0,100,0.6)] flex items-center justify-center relative animate-bounce-slight transition-all hover:scale-105 active:scale-95">
                    <!-- Lid -->
                    <div
                        class="lid absolute top-0 left-0 w-44 h-10 bg-pink-700 -ml-2 -mt-2 rounded-md shadow-lg z-20 transition-transform origin-bottom duration-700 text-center flex items-center justify-center border-b-4 border-pink-900 overflow-hidden">
                        <div class="w-full h-4 bg-yellow-400 absolute top-1/2 transform -translate-y-1/2 shadow-sm">
                        </div>
                        <div
                            class="w-12 h-12 bg-yellow-400 rounded-full -mt-8 border-4 border-pink-800 shadow-md relative z-30 flex items-center justify-center">
                            <span class="text-[10px]">üéÄ</span>
                        </div>
                    </div>
                    <!-- Box Body -->
                    <div class="absolute w-10 h-full bg-yellow-400 z-10 border-l border-r border-yellow-500/20"></div>
                    <div
                        class="absolute h-10 w-full bg-yellow-400 z-10 top-1/2 transform -translate-y-1/2 border-t border-b border-yellow-500/20">
                    </div>
                    <div class="text-white text-5xl font-bold z-10 relative drop-shadow-md animate-pulse">?</div>
                </div>
            </div>

            <p class="mt-12 z-10 text-sm text-pink-200 animate-pulse tracking-widest uppercase">Tap to open</p>
        </section>

        <footer class="text-center py-6 text-xs text-slate-400/50 pb-24">
            Forever & Always ‚ù§Ô∏è
        </footer>
    </main>

    <!-- Letter Modal -->
    <div id="letter-modal"
        class="fixed inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-700">
        <div class="bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')] bg-[#fffdf0] text-gray-800 w-11/12 max-w-lg p-8 rounded-xl shadow-2xl transform scale-90 transition-transform duration-500 relative border-8 border-double border-pink-200"
            id="letter-content">
            <button id="close-letter"
                class="absolute top-2 right-2 text-pink-400 hover:text-pink-600 text-2xl transition-colors">√ó</button>
            <h3 class="text-3xl font-dancing text-pink-600 mb-6 border-b-2 border-pink-100 pb-2">G·ª≠i √Ånh,</h3>
            <div id="typewriter-text"
                class="font-nunito leading-relaxed text-base md:text-lg min-h-[200px] text-gray-700">
                <!-- Text will be typed here via JS -->
            </div>
            <div class="mt-8 text-right font-dancing text-2xl text-pink-600">
                - Ng∆∞·ªùi y√™u em -
            </div>

            <!-- Decor -->
            <div class="absolute -bottom-4 -right-4 text-6xl opacity-20 rotate-12">üíã</div>
        </div>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" class="fixed inset-0 z-50 pointer-events-none"></canvas>

    <script>
        // --- CONSTANTS ---
        const PASSCODE = "0508";
        // UPDATED DATE: FEB 3, 2026
        const START_DATE = new Date("2025-10-10T00:00:00");

        const MESSAGES = [
            "Y√™u em l√† ƒëi·ªÅu tuy·ªát v·ªùi nh·∫•t...",
            "M·ªói ng√†y b√™n em l√† m·ªôt m√≥n qu√†.",
            "C·∫£m ∆°n em v√¨ ƒë√£ ƒë·∫øn b√™n anh!",
            "Em l√† √°nh s√°ng c·ªßa ƒë·ªùi anh. ‚ú®",
            "M√£i b√™n nhau em nh√©! ‚ù§Ô∏è"
        ];

        const FINAL_MESSAGE = "Ch√∫c m·ª´ng Valentine ƒë·∫ßu ti√™n c·ªßa ch√∫ng m√¨nh! C·∫£m ∆°n em ƒë√£ xu·∫•t hi·ªán v√† khi·∫øn th·∫ø gi·ªõi c·ªßa anh tr·ªü n√™n d·ªãu d√†ng h∆°n. Y√™u em r·∫•t nhi·ªÅu c√¥ c√¥ng ch√∫a nh·ªè c·ªßa anh! ‚ù§Ô∏èüåπ";

        // --- DOM ELEMENTS ---
        const lockScreen = document.getElementById('lock-screen');
        const mainContent = document.getElementById('main-content');
        const keypadBtns = document.querySelectorAll('.keypad-btn');
        const dots = document.querySelectorAll('.dot');
        const bgMusic = document.getElementById('bg-music');
        const musicToggle = document.getElementById('music-toggle');
        const giftBox = document.querySelector('.gift-box');
        const letterModal = document.getElementById('letter-modal');
        const letterContent = document.getElementById('letter-content');
        const typewriterText = document.getElementById('typewriter-text');
        const closeLetter = document.getElementById('close-letter');
        const typingTitle = document.getElementById('typing-title');
        const carouselText = document.getElementById('carousel-text');

        // --- STATE ---
        let inputSequence = "";
        let isMusicPlaying = false;

        // --- CLICK INTERACTION (HEARTS) ---
        document.addEventListener('click', (e) => {
            createHeart(e.clientX, e.clientY);
        });

        function createHeart(x, y) {
            const heart = document.createElement('div');
            heart.innerText = ['‚ù§Ô∏è', 'üíñ', 'üíù', 'üíï', 'üåπ'][Math.floor(Math.random() * 5)];
            heart.classList.add('click-heart');
            heart.style.left = `${x}px`;
            heart.style.top = `${y}px`;
            heart.style.left = (x - 15) + 'px'; // Center adjust
            heart.style.top = (y - 15) + 'px';

            // Randomize movement slightly
            const tx = (Math.random() - 0.5) * 50;
            heart.style.setProperty('--tx', `${tx}px`);

            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 1500);
        }

        // --- LOCK SCREEN LOGIC ---
        keypadBtns.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent extra heart spawn on keypad
                if (navigator.vibrate) navigator.vibrate(40);

                const val = btn.getAttribute('data-val');
                if (val === 'del') {
                    inputSequence = inputSequence.slice(0, -1);
                } else if (inputSequence.length < 4) {
                    inputSequence += val;
                }
                updateDots();
                if (inputSequence.length === 4) checkPasscode();
            });
        });

        function updateDots() {
            dots.forEach((dot, index) => {
                if (index < inputSequence.length) {
                    dot.classList.remove('bg-transparent');
                    dot.classList.add('bg-pink-500', 'scale-110');
                } else {
                    dot.classList.add('bg-transparent');
                    dot.classList.remove('bg-pink-500', 'scale-110');
                }
            });
        }

        function checkPasscode() {
            if (inputSequence === PASSCODE) {
                unlockApp();
            } else {
                setTimeout(() => {
                    inputSequence = "";
                    updateDots();
                    lockScreen.classList.add('animate-pulse');
                    if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
                    setTimeout(() => lockScreen.classList.remove('animate-pulse'), 500);
                }, 300);
            }
        }

        function unlockApp() {
            lockScreen.style.opacity = '0';
            lockScreen.style.pointerEvents = 'none';
            setTimeout(() => {
                mainContent.classList.remove('hidden');
                mainContent.offsetHeight; // Reflow
                mainContent.style.opacity = '1';
                document.body.style.overflowY = 'auto';
                playMusic();
                typeTitle(); // Start entering animation
            }, 800);
        }

        function typeTitle() {
            const text = "Ch√†o c√¥ng ch√∫a √Ånh!";
            let i = 0;
            typingTitle.innerHTML = "";
            const interval = setInterval(() => {
                typingTitle.innerHTML += text.charAt(i);
                i++;
                if (i >= text.length) clearInterval(interval);
            }, 100);
        }

        // --- MUSIC ---
        musicToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            if (isMusicPlaying) {
                bgMusic.pause();
                musicToggle.innerHTML = 'üîá';
                musicToggle.classList.remove('animate-spin');
            } else {
                bgMusic.play();
                musicToggle.innerHTML = 'üéµ';
                musicToggle.classList.add('animate-spin');
            }
            isMusicPlaying = !isMusicPlaying;
        });

        function playMusic() {
            bgMusic.play().then(() => {
                isMusicPlaying = true;
                musicToggle.classList.add('animate-spin');
            }).catch(() => {
                console.log("Autoplay blocked");
                musicToggle.innerHTML = 'üîá';
            });
        }

        // --- TIMER LOGIC ---
        function updateTimer() {
            const now = new Date();
            const diff = now - START_DATE;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / 1000 / 60) % 60);
            const seconds = Math.floor((diff / 1000) % 60);

            document.getElementById('days').innerText = String(days).padStart(2, '0');
            document.getElementById('hours').innerText = String(hours).padStart(2, '0');
            document.getElementById('minutes').innerText = String(minutes).padStart(2, '0');
            document.getElementById('seconds').innerText = String(seconds).padStart(2, '0');
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // --- MESSAGE CAROUSEL ---
        let msgIndex = 0;
        setInterval(() => {
            carouselText.style.opacity = '0';
            setTimeout(() => {
                msgIndex = (msgIndex + 1) % MESSAGES.length;
                carouselText.innerText = MESSAGES[msgIndex];
                carouselText.style.opacity = '1';
            }, 1000);
        }, 4000);

        // --- GIFT & CONFETTI ---
        document.getElementById('gift-box-trigger').addEventListener('click', (e) => {
            e.stopPropagation();
            if (document.querySelector('.lid').style.transform) return;

            giftBox.classList.add('open');
            startConfetti();
            setTimeout(() => showLetter(), 1000);
        });

        function showLetter() {
            letterModal.classList.remove('pointer-events-none', 'opacity-0');
            letterContent.classList.remove('scale-90');
            letterContent.classList.add('scale-100');

            let i = 0;
            typewriterText.innerHTML = "";
            function type() {
                if (i < FINAL_MESSAGE.length) {
                    typewriterText.innerHTML += FINAL_MESSAGE.charAt(i);
                    i++;
                    setTimeout(type, 40); // Faster typing
                }
            }
            type();
        }

        closeLetter.addEventListener('click', (e) => {
            e.stopPropagation();
            letterModal.classList.add('opacity-0', 'pointer-events-none');
            letterContent.classList.add('scale-90');
            letterContent.classList.remove('scale-100');
        });

        // --- CONFETTI ---
        const confettiCanvas = document.getElementById('confetti-canvas');
        const cCtx = confettiCanvas.getContext('2d');
        let confettiParticles = [];

        function resizeConfetti() {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeConfetti);
        resizeConfetti();

        function createConfettiPiece() {
            return {
                x: window.innerWidth / 2,
                y: window.innerHeight / 2 + 100,
                w: Math.random() * 10 + 5,
                h: Math.random() * 10 + 5,
                color: ['#be185d', '#ec4899', '#f472b6'].sort(() => Math.random() - 0.5)[0],
                vx: (Math.random() - 0.5) * 20,
                vy: -Math.random() * 20 - 10,
                gravity: 0.5,
                rotation: Math.random() * 360,
                rotationSpeed: (Math.random() - 0.5) * 10
            };
        }

        function startConfetti() {
            for (let k = 0; k < 120; k++) confettiParticles.push(createConfettiPiece());
            animateConfetti();
        }

        function animateConfetti() {
            if (confettiParticles.length === 0) return;
            cCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
            confettiParticles.forEach((p, index) => {
                p.x += p.vx;
                p.y += p.vy;
                p.vy += p.gravity;
                p.rotation += p.rotationSpeed;
                cCtx.save();
                cCtx.translate(p.x, p.y);
                cCtx.rotate(p.rotation * Math.PI / 180);
                cCtx.fillStyle = p.color;
                cCtx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
                cCtx.restore();
                if (p.y > window.innerHeight) confettiParticles.splice(index, 1);
            });
            requestAnimationFrame(animateConfetti);
        }

        // --- BACKGROUND HEARTS (CANVAS) ---
        const bgCanvas = document.getElementById('particles-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        let particles = [];

        function resizeBg() { bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight; }
        window.addEventListener('resize', resizeBg);
        resizeBg();

        class Particle {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * bgCanvas.width;
                this.y = window.innerHeight + Math.random() * 100; // Start bottom
                this.size = Math.random() * 20 + 10;
                this.speedY = Math.random() * 1 + 0.5;
                this.opacity = 0;
                this.fadeState = "in";
                this.text = ["‚ù§Ô∏è", "‚ú®", "üå∏"][Math.floor(Math.random() * 3)];
            }
            update() {
                this.y -= this.speedY;
                if (this.fadeState === "in") {
                    this.opacity += 0.01;
                    if (this.opacity >= 1) this.fadeState = "out";
                } else {
                    this.opacity -= 0.01;
                    if (this.opacity <= 0) this.reset();
                }
                if (this.y < -50) this.reset();
            }
            draw() {
                bgCtx.globalAlpha = this.opacity;
                bgCtx.font = `${this.size}px Arial`;
                bgCtx.fillText(this.text, this.x, this.y);
                bgCtx.globalAlpha = 1;
            }
        }

        function initBg() {
            for (let i = 0; i < 30; i++) particles.push(new Particle());
            animateBg();
        }
        function animateBg() {
            bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animateBg);
        }
        initBg();
    </script>
</body>

</html>